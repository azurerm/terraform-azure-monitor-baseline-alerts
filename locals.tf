locals {
  path_policies    = "${path.root}/${var.path_policies}/"
  path_initiatives = "${path.root}/${var.path_initiatives}/"
  
  policies    = fileset(local.path_policies, "**/*.json")
  initiatives = fileset(local.path_initiatives, "*.json")

  policy-reference-map = {
    "ALZ_svcHlthSecAdvisory"                    = "Deploy-ActivityLog-ServiceHealth-Security.json"
    "ALZ_ResHlthUnhealthy"                      = "Deploy-ActivityLog-ResourceHealth-UnHealthly-Alert.json"
    "ALZ_SvcHlthAdvisory"                       = "Deploy-ActivityLog-ServiceHealth-Health.json"
    "ALZ_SvcHlthIncident"                       = "Deploy-ActivityLog-ServiceHealth-Incident.json"
    "ALZ_SvcHlthMaintenance"                    = "Deploy-ActivityLog-ServiceHealth-Maintenance.json"
    "ALZ_ServiceHealth_ActionGroups"            = "Deploy-ServiceHealth-ActionGroups.json"
    "ALZ_AlertProcessing_Rule"                  = "Deploy-AlertProcessingRule-Deploy.json"
    "ALZ_Suppression_AlertProcessing_Rule"      = "Deploy-AlertProcessingRule-Suppression.json"
    "ALZ_ERCIRQoSDropBitsinPerSec"              = "Deploy-ERCIR-QOSDropsBitsIn-Alert.json"
    "ALZ_ERCIRQoSDropBitsoutPerSec"             = "Deploy-ERCIR-QOSDropsBitsOut-Alert.json"
    "ALZ_ERPBitsInPerSecond"                    = "Deploy-ERP-BitsInPerSecond-Alert.json"
    "ALZ_ERPBitsOutPerSecond"                   = "Deploy-ERP-BitsOutPerSecond-Alert.json"
    "ALZ_ERPLineProtocol"                       = "Deploy-ERP-LineProtocol-Alert.json"
    "ALZ_ERPRxLightLevelHigh"                   = "Deploy-ERP-RxLightLevelHigh-Alert.json"
    "ALZ_ERPRxLightLevelLow"                    = "Deploy-ERP-RxLightLevelLow-Alert.json"
    "ALZ_ERPTxLightLevelHigh"                   = "Deploy-ERP-TxLightLevelHigh-Alert.json"
    "ALZ_ERPTxLightLevelLow"                    = "Deploy-ERP-TxLightLevelLow-Alert.json"
    "ALZ_VPNGwBGPPeerStatus"                    = "Deploy-VPNG-BGPPeerStatus-Alert.json"
    "ALZ_VnetGwERCpuUtil"                       = "Deploy-VNETG-ERGCPUUtilization-Alert.json"
    "ALZ_VnetGwTunnelBW"                        = "Deploy-VNETG-BandwidthUtilization-Alert.json"
    "ALZ_VnetGwTunnelEgress"                    = "Deploy-VNETG-Egress-Alert.json"
    "ALZ_VnetGwTunnelIngress"                   = "Deploy-VNETG-Ingress-Alert.json"
    "ALZ_VPNGWBandWidthUtil"                    = "Deploy-VPNG-BandwidthUtilization-Alert.json"
    "ALZ_VPNGWEgress"                           = "Deploy-VPNG-Egress-Alert.json"
    "ALZ_VPNGWTunnelEgressPacketDropCount"      = "Deploy-VPNG-EgressPacketDropCount-Alert.json"
    "ALZ_VPNGWTunnelEgressPacketDropMismatch"   = "Deploy-VPNG-EgressPacketDropMismatch-Alert.json"
    "ALZ_VPNGWIngress"                          = "Deploy-VPNG-Ingress-Alert.json"
    "ALZ_VPNGWTunnelIngressPacketDropCount"     = "Deploy-VPNG-IngressPacketDropCount-Alert.json"
    "ALZ_VPNGWTunnelIngressPacketDropMismatch"  = "Deploy-VPNG-IngressPacketDropMismatch-Alert.json"
    "ALZ_PDNSZCapacityUtil"                     = "Deploy-PDNSZ-CapacityUtilization-Alert.json"
    "ALZ_PDNSZQueryVolume"                      = "Deploy-PDNSZ-QueryVolume-Alert.json"
    "ALZ_PDNSZRecordSetCapacity"                = "Deploy-PDNSZ-RecordSetCapacity-Alert.json"
    "ALZ_PDNSZRegistrationCapacityUtil"         = "Deploy-PDNSZ-RegistrationCapacityUtilization-Alert.json"
    "ALZ_ERGwExpressRouteBitsIn"                = "Deploy-ERG-BitsInPerSecond-Alert.json"
    "ALZ_ERGwExpressRouteBitsOut"               = "Deploy-ERG-BitsOutPerSecond-Alert.json"
    "ALZ_ERGwExpressRouteCpuUtil"               = "Deploy-ERG-CPUUtilization-Alert.json"
    "ALZ_VnetGwTunnelEgressPacketDropMismatch"  = "Deploy-VNETG-EgressPacketDropMismatch-Alert.json"
    "ALZ_VnetGwExpressRouteBitsPerSecond"       = "Deploy-VNETG-ERGBitsPerSecond-Alert.json"
    "ALZ_VnetGwTunnelIngressPacketDropMismatch" = "Deploy-VNETG-IngressPacketDropMismatch-Alert.json"
    "ALZ_VnetGwTunnelIngressPacketDropCount"    = "Deploy-VNETG-IngressPacketDropCount-Alert.json"
    "ALZ_VnetGwTunnelEgressPacketDropCount"     = "Deploy-VNETG-IngressPacketDropCount-Alert.json"
    "ALZ_ERCIRBgpAvailability"                  = "Deploy-ERCIR-BGPAvailability-Alert.json"
    "ALZ_ERCIRArpAvailability"                  = "Deploy-ERCIR-ARPAvailability-Alert.json"
    "ALZ_AFWSNATPortUtilization"                = "Deploy-AFW-SNATPortUtilization-Alert.json"
    "ALZ_FirewallHealth"                        = "Deploy-AFW-FirewallHealth-Alert.json"
    "ALZ_PIPBytesInDDoSEvaluationFrequency"     = "Deploy-PIP-BytesInDDOSAttack-Alert.json"
    "ALZ_PIPDDoSAttack"                         = "Deploy-PIP-DDOSAttack-Alert.json"
    "ALZ_PIPPacketsInDDoS"                      = "Deploy-PIP-PacketsInDDOS-Alert.json"
    "ALZ_PIPVIPAvailability"                    = "Deploy-PIP-VIPAvailability-Alert.json"
    "ALZ_VNETDDOSAttack"                        = "Deploy-VNET-DDOSAttack-Alert.json"
    "ALZ_LBDataPathAvailability"                = "Deploy-LB-DatapathAvailability-Alert.json"
    "ALZ_LBGlobalBackendAvailability"           = "Deploy-LB-GlobalBackendAvailability-Alert.json"
    "ALZ_LBHealthProbeStatus"                   = "Deploy-LB-HealthProbeStatus-Alert.json"
    "ALZ_LBUsedSNATPorts"                       = "Deploy-LB-UsedSNATPorts-Alert.json"
    "ALZ_activityFWDelete"                      = "Deploy-ActivityLog-AzureFirewall-Del.json"
    "ALZ_activityNSGDelete"                     = "Deploy-ActivityLog-NSG-Del.json"
    "ALZ_activityVPNGWDelete"                   = "Deploy-ActivityLog-VPNG-Del.json"
    "ALZ_AATotalJob"                            = "Deploy-AA-TotalJob-Alert.json"
    "ALZ_RVBackupHealth"                        = "Modify-RSV-BackupHealth-Alert.json"
    "ALZ_StorageAccountAvailability"            = "Deploy-SA-Availability-Alert.json"
    "ALZ_activitySADelete"                      = "Deploy-ActivityLog-SA-Delete-Alert.json"
    "ALZ_activityLAWDelete"                     = "Deploy-ActivityLog-LAWorkspace-Del.json"
    "ALZ_activityLAWKeyRegen"                   = "Deploy-ActivityLog-LAWorkspace-KeyRegen.json"
    "ALZ_KVRequest"                             = "Deploy-KV-Requests-Alert.json"
    "ALZ_KvAvailability"                        = "Deploy-KV-Availability-Alert.json"
    "ALZ_KvLatencyAvailability"                 = "Deploy-KV-Latency-Alert.json"
    "ALZ_KVCapacity"                            = "Deploy-KV-Capacity-Alert.json"
    "ALZ_activityKVDelete"                      = "Deploy-ActivityLog-KeyVault-Del.json"
    "ALZ_activityUDRUpdate"                     = "Deploy-ActivityLog-RouteTable-Update.json"
    "ALZ_VMHeartBeatRG"                         = "Deploy-VM-HeartBeat-Alert.json"
    "ALZ_VMNetworkIn"                           = "Deploy-VM-NetworkIn-Alert.json"
    "ALZ_VMNetworkOut"                          = "Deploy-VM-NetworkOut-Alert.json"
    "ALZ_VMOSDiskReadLatency"                   = "Deploy-VM-OSDiskReadLatency-Alert.json"
    "ALZ_VMOSDiskWriteLatency"                  = "Deploy-VM-OSDiskWriteLatency-Alert.json"
    "ALZ_VMOSDiskSpace"                         = "Deploy-VM-OSDiskSpace-Alert.json"
    "ALZ_VMPercentCPU"                          = "Deploy-VM-PercentCPU-Alert.json"
    "ALZ_VMPercentMemory"                       = "Deploy-VM-PercentMemory-Alert.json"
    "ALZ_VMDataDiskSpace"                       = "Deploy-VM-DataDiskSpace-Alert.json"
    "ALZ_VMDataDiskReadLatency"                 = "Deploy-VM-DataDiskReadLatency-Alert.json"
    "ALZ_VMDataDiskWriteLatency"                = "Deploy-VM-DataDiskWriteLatency-Alert.json"
    "ALZ_AGWTotalTime"                          = "Deploy-AGW-ApplicationGatewayTotalTime-Alert.json"
    "ALZ_AGWBackendLastByteResponseTime"        = "Deploy-AGW-BackendLastByteResponseTime-Alert.json"
    "ALZ_AGWCapacityUnits"                      = "Deploy-AGW-CapacityUnits-Alert.json"
    "ALZ_AGWComputeUnits"                       = "Deploy-AGW-ComputeUnits-Alert.json"
    "ALZ_AGWCPUUtilization"                     = "Deploy-AGW-CPUUtil-Alert.json"
    "ALZ_AGWFailedRequests"                     = "Deploy-AGW-FailedRequests-Alert.json"
    "ALZ_AGWResponseStatus"                     = "Deploy-AGW-ResponseStatus-Alert.json"
    "ALZ_AGWUnhealthyHostCount"                 = "Deploy-AGW-UnhealthyHostCount-Alert.json"
    "ALZ_CDNPOriginHealthPercentage"            = "Deploy-CDNP-OriginHealthPercentage-Alert.json"
    "ALZ_CDNPOriginLatency"                     = "Deploy-CDNP-OriginLatency-Alert.json"
    "ALZ_CDNPPercentage4XX"                     = "Deploy-CDNP-Percentage4XX-Alert.json"
    "ALZ_CDNPPercentage5XX"                     = "Deploy-CDNP-Percentage5XX-Alert.json"
    "ALZ_TMEndpointHealth"                      = "Deploy-TM-EndpointHealth-Alert.json"
    "ALZ_WSFCPUPercentage"                      = "Deploy-WSF-CPUPercentage-Alert.json"
    "ALZ_WSFMemoryPercentage"                   = "Deploy-WSF-MemoryPercentage-Alert.json"
    "ALZ_WSFDiskQueueLength"                    = "Deploy-WSF-DiskQueueLength-Alert.json"
    "ALZ_WSFHttpQueueLength"                    = "Deploy-WSF-HttpQueueLength-Alert.json"
    "ALZ_FDBackendHealth"                       = "Deploy-FD-BackendHealth-Alert.json"
    "ALZ_FDBackendRequestLatency"               = "Deploy-FD-BackendRequestLatency-Alert.json"
    "ALZ_HybridVMPercentCPU"                    = "Deploy-Hybrid-VM-PercentCPU-Alert.json"
    "ALZ_HybridVMDataDiskReadLatency"           = "Deploy-Hybrid-VM-DataDiskReadLatency-Alert.json"
    "ALZ_HybridVMDataDiskSpace"                 = "Deploy-Hybrid-VM-DataDiskSpace-Alert.json"
    "ALZ_HybridVMDataDiskWriteLatency"          = "Deploy-Hybrid-VM-DataDiskWriteLatency-Alert.json"
    "ALZ_HybridVMDisconnected"                  = "Deploy-Hybrid-VM-Disconnected-Alert.json"
    "ALZ_HybridVMHeartBeatRG"                   = "Deploy-Hybrid-VM-HeartBeat-Alert.json"
    "ALZ_HybridVMPercentMemory"                 = "Deploy-Hybrid-VM-PercentMemory-Alert.json"
    "ALZ_HybridVMNetworkIn"                     = "Deploy-Hybrid-VM-NetworkIn-Alert.json"
    "ALZ_HybridVMNetworkOut"                    = "Deploy-Hybrid-VM-NetworkOut-Alert.json"
    "ALZ_HybridVMOSDiskReadLatency"             = "Deploy-Hybrid-VM-OSDiskReadLatency-Alert.json"
    "ALZ_HybridVMOSDiskSpace"                   = "Deploy-Hybrid-VM-OSDiskSpace-Alert.json"
    "ALZ_HybridVMOSDiskWriteLatency"            = "Deploy-Hybrid-VM-OSDiskWriteLatency-Alert.json"
  }
}
